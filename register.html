<!DOCTYPE HTML>
<html>
<head>
	<title>Register for WebCivilazation</title>
	<style>
		body{background-color: #b0c4de;}
		h1.Register{font-family: "Consolas"font-style: bold;}
		h2.Register{font-family: "Consolas";}
		div.form_field{font-family: "Consolas";font-style: bold;font-size: 18px;}
	</style>
	<script>
		function register()
		{
			var usr = document.getElementById("usr").value;
			var pwd = document.getElementById("pwd").value;
			if(!usr)
			{
				alert("Empty user name is not allowed !");
				return false;
			}
			if(!pwd)
			{
				alert("Empty password is not allowed !");
				return false;
			}	
			var xhr = new XMLHttpRequest();
			xhr.open("POST","login/register.php",true);
			xhr.setRequestHeader('username',usr);
			xhr.setRequestHeader('password',pwd);
			xhr.send();
			xhr.onreadystatechange = function(){
				if(xhr.readyState == 4)
				{
					if(xhr.status != 200)
					{
						alert("Error code = " + new String(xhr.status));
						return false;
					}
					var msg = document.getElementById("message");
					msg.innerHTML = xhr.responseText;
					if(xhr.responseText == "Register successfully, you will be redirect to login page in 5 seconds.")
					{
						var time = 0;
						var url = 'login.html';
						function forward_to(){
							 time ++;
							 if(time == 5){
								 document.location.href = url;
							 }
							 document.getElementById("message").innerHTML = "Register successfully, you will be redirect to login page in " + (5 - time) + "seconds.";
						}
						window.setInterval("forward_to()",1000);
					}
				}
			};
			return false;
		}
	</script>

</head>
<body>
	<div id="register_form">
	<h1 class="Register">WelCome to WebCivilization!</h1>
	<h2 class="Register">Register Now !</h2>
	
	<div class="form_field">
	Username: <input id="usr" type="text"><br>
	Password: <input id="pwd" type="password"><br>
	</div>
	<button type="button" onclick="register()">regsiter !</button>
	</div>
	<p id=message></p>
</body>
</html>
